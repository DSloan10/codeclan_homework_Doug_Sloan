---
title: "R Notebook"
output: html_notebook
---


```{r}
library(tidyverse)
library(tidytext)
library(ggwordcloud)
library(janeaustenr)
library()


```

Using the dataset austen_books() from the package janeaustenr:

Find the most common words in both Pride & Prejudice and Sense & Sensibility.

```{r}
pap_data <- paste(janeaustenr::prideprejudice, collapse = " ")

sas_data <- paste(janeaustenr::sensesensibility, collapse = " ")
```


```{r}
pap_and_sas_books <- tibble(
  book = c("Pride and Prejudice", "Sense and Sensibility"),
  text = c(pap_data, sas_data)
)
```

*Here's the most popular word in each:*

```{r}
pap_and_sas_books %>% 
  unnest_tokens(word, text) %>%
  count(book, word) %>% 
  group_by(book) %>% 
  slice_max(n)
```
*And here's the most popular combined:

```{r}
pap_and_sas_books_no_labels <- tibble(
  text = c(pap_data, sas_data)
)
```

```{r}
pap_and_sas_books_no_labels %>% 
  unnest_tokens(word, text) %>%
  count(word) %>% 
  arrange(desc(n)) %>% 
  slice_max(n)
```


Find the most common words in both Pride & Prejudice and Sense & Sensibility, not including stop words.

```{r}
pap_and_sas_books %>% 
  unnest_tokens(word, text) %>%
  count(book, word) %>% 
  anti_join(stop_words) %>% 
  group_by(book) %>% 
  slice_max(n)
  
```

```{r}
pap_and_sas_books_no_labels %>% 
  unnest_tokens(word, text) %>%
  count(word) %>%
  anti_join(stop_words) %>% 
  arrange(desc(n)) %>% 
  slice_max(n)
```


Find the most common sentiment words in both Pride & Prejudice and Sense & Sensibility.

```{r}
pap_and_sas_books %>% 
  unnest_tokens(word, text) %>%
  count(book, word) %>% 
  anti_join(stop_words) %>% 
  inner_join(get_sentiments("afinn")) %>% 
  filter(!word == "miss") %>% 
  slice_max(n, n = 10)

```


Taking your results above. Can you create a plot which visualises the differences between the books?

